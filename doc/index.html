<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h1>Smartcar Node SDK <a href="https://travis-ci.com/smartcar/node-sdk"><img src="https://travis-ci.com/smartcar/node-sdk.svg?token=jMbuVtXPGeJMPdsn7RQ5&amp;branch=master" alt="Build Status"></a> <a href="https://badge.fury.io/js/smartcar"><img src="https://badge.fury.io/js/smartcar.svg" alt="npm version"></a></h1>
<p>The official Smartcar Node SDK.</p>
<h2>Overview</h2>
<p>The <a href="https://smartcar.com/docs">Smartcar API</a> lets you read vehicle data
(location, odometer) and send commands to vehicles (lock, unlock) using HTTP requests.</p>
<p>To make requests to a vehicle from a web or mobile application, the end user
must connect their vehicle using
<a href="https://smartcar.com/docs/api#smartcar-connect">Smartcar Connect</a>.
This flow follows the OAuth spec and will return a <code>code</code> which can be used to
obtain an access token from Smartcar.</p>
<p>The Smartcar Node SDK provides methods to:</p>
<ol>
<li>Generate the link to redirect to Connect.</li>
<li>Make a request to Smartcar with the <code>code</code> obtained from Connect to obtain an
access and refresh token</li>
<li>Make requests to the Smartcar API to read vehicle data and send commands to
vehicles using the access token obtained in step 2.</li>
</ol>
<p>Before integrating with Smartcar's SDK, you'll need to register an application
in the <a href="https://developer.smartcar.com">Smartcar Developer portal</a>. If you do
not have access to the dashboard, please
<a href="https://smartcar.com/subscribe">request access</a>.</p>
<h3>Flow</h3>
<ul>
<li>Create a new <code>AuthClient</code> object with your <code>clientId</code>, <code>clientSecret</code>,
<code>redirectUri</code>, and required <code>scope</code>.</li>
<li>Redirect the user to Smartcar Connect using <code>getAuthUrl</code> or one
of our frontend SDKs.</li>
<li>The user will login, and then accept or deny your <code>scope</code>'s permissions.</li>
<li>Handle the get request to <code>redirectUri</code>.
<ul>
<li>If the user accepted your permissions, <code>req.query.code</code> will contain an
authorization code.
<ul>
<li>Use <code>exchangeCode</code> with this code to obtain an access object
containing an access token (lasting 2 hours) and a refresh token
(lasting 60 days).
<ul>
<li>Save this access object.</li>
</ul>
</li>
<li>If the user denied your permissions, <code>req.query.error</code> will be set
to <code>&quot;access_denied&quot;</code>.</li>
<li>If you passed a state parameter to <code>getAuthUrl</code>, <code>req.query.state</code> will
contain the state value.</li>
</ul>
</li>
</ul>
</li>
<li>Get the user's vehicles with <code>getVehicleIds</code>.</li>
<li>Create a new <code>Vehicle</code> object using a <code>vehicleId</code> from the previous response,
and the <code>access_token</code>.</li>
<li>Make requests to the Smartcar API.</li>
<li>Use <code>exchangeRefreshToken</code> on your saved <code>refreshToken</code> to retrieve a new token
when your <code>accessToken</code> expires.</li>
</ul>
<h3>Installation</h3>
<pre class="prettyprint source lang-shell"><code>npm install smartcar --save
</code></pre>
<h3>Example</h3>
<pre class="prettyprint source lang-javascript"><code>'use strict';

const smartcar = require('smartcar');
const express = require('express');

const app = express();

const port = 4000;

const client = new smartcar.AuthClient({
  clientId: 'SMARTCAR_CLIENT_ID',
  clientSecret: 'SMARTCAR_CLIENT_SECRET',
  redirectUri: 'YOUR_CALLBACK_URI',
  scope: ['read_vehicle_info'],
  testMode: true, // launch Smartcar Connect in test mode
});

// Redirect to Smartcar Connect
app.get('/login', function(req, res) {
  const link = client.getAuthUrl();

  // redirect to the link
  res.redirect(link);
});

// Handle Smartcar callback with auth code
app.get('/callback', function(req, res, next) {
  let access;

  if (req.query.error) {
    // the user denied your requested permissions
    return next(new Error(req.query.error));
  }

  // exchange auth code for access token
  return client
    .exchangeCode(req.query.code)
    .then(function(_access) {
      // in a production app you'll want to store this in some kind of persistent storage
      access = _access;
      // get the user's vehicles
      return smartcar.getVehicleIds(access.accessToken);
    })
    .then(function(res) {
      // instantiate first vehicle in vehicle list
      const vehicle = new smartcar.Vehicle(res.vehicles[0], access.accessToken);
      // get identifying information about a vehicle
      return vehicle.info();
    })
    .then(function(data) {
      console.log(data);
      // {
      //   &quot;id&quot;: &quot;36ab27d0-fd9d-4455-823a-ce30af709ffc&quot;,
      //   &quot;make&quot;: &quot;TESLA&quot;,
      //   &quot;model&quot;: &quot;Model S&quot;,
      //   &quot;year&quot;: 2014
      // }

      // json response will be sent to the user
      res.json(data);
    });
});

app.listen(port, () => console.log(`Listening on port ${port}`));
</code></pre>
<h2>SDK Reference</h2>
<p>For detailed documentation on parameters and available methods, please refer to
the <a href="doc/readme.md">SDK Reference</a>.</p>
<h2>Contributing</h2>
<p>To contribute, please:</p>
<ol>
<li>Open an issue for the feature (or bug) you would like to resolve.</li>
<li>Resolve the issue and add tests in your feature branch.</li>
<li>Open a PR from your feature branch into <code>develop</code> that tags the issue.</li>
</ol>
<p>To test:</p>
<pre class="prettyprint source lang-shell"><code>npm run test
</code></pre></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-errors.html">errors</a></li><li><a href="module-smartcar.html">smartcar</a></li></ul><h3>Classes</h3><ul><li><a href="AuthClient.html">AuthClient</a></li><li><a href="Vehicle.html">Vehicle</a></li></ul><h3>Global</h3><ul><li><a href="global.html#parseAge">parseAge</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Thu Oct 24 2019 11:31:33 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>